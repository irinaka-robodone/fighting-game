# ターン制コマンド入力式格闘ゲーム

## ゲームの概要
このゲームは、プレイヤーとCPUがターン制で技を出し合い、相手のHPを0以下にして倒した方が勝利するゲームです。

技は [q], [w], [e], [r] の4つのキーを押すことで選択できます。

## ゲームの実行方法

1. このリポジトリをクローン（ダウンロード）して、ダウンロードしたディレクトリに移動します。
1. 以下のコマンドをターミナルで実行してください。このゲームを動かすのに必要なパッケージがインストールされます。実行には Python 3.10 以上が必要です。
    ```bash
    pip install -r requirements.txt
    ```
1. 以下のコマンドを実行してください。[src](src) ディレクトリにある `game.py` が実行されます。これはこのゲームのメインファイルです。
    ```bash
    python src/game.py
    ```

## ゲームの主な仕様

### ゲームの構成
各ターンを以下の２つのフェーズに分けて、どちらかのHPが0以下になるまで繰り返すシンプルなターン制格闘ゲームです。
1. プレイヤー同士が繰り出す技を選択するフェーズ
2. 選択した技の結果が知らされるフェーズ

### ファイル構成
このリポジトリには以下のファイルが含まれています。
- [README.md](README.md) このファイルです。
- [requirements.txt](requirements.txt) このゲームを動かすのに必要なパッケージが記述されています。
- [src](src) ゲームを動かす全てのコードが含まれています。
    - [game.py](src/game.py) このゲームのメインファイルです。このファイルを実行することでゲームが開始します。
    - [utils.py](src/utils.py) ゲーム内で特定のシーンに関わらずよく使う関数がまとめられています。
    - [world.py](src/world.py) ゲームのシステム、画面描画などゲームの仕組みが全て書かれています。ゲームのシステムを変更したい場合はこのファイルを編集してください。

### 実行ファイルを作成する
このコードから実行ファイルを作成することができます。実行ファイルとは、Pythonがインストールされていない環境でも実行できるようにしたものです。以下のコマンドを実行することで、このゲームの実行ファイルを作成できます。

PyInstaller というPython のパッケージをインストールして使うことで、Python のスクリプトを実行ファイルに変換することができます。

詳しくは以下の記事を参考にチャレンジしてみてください。
- https://challenge-pg.com/2023/08/17/pyinstaller/
- https://qiita.com/firedfly/items/f6de5cfb446da4b53eeb
- https://pyinstaller.org/en/stable/usage.html

## 見つかっている不具合・FAQ
### ゲーム開始時、入力したのにプレイヤーの名前が確定できない
全角入力している場合まれに発生します。入力中に一度半角に切り替え、全角に戻すと正常に入力が反映されるようになります。

このゲームの日本語入力機能は @DYGV氏の https://github.com/DYGV/pygame_textinput に依存しています。

### プレイヤーどちらも技の選択を終了した後、結果が表示されるまで時間がかかる
技を受ける前の自分のHPや繰り出した技を元に、各プレイヤーのセリフをAIが生成しています。
AIがセリフを生成するまで時間がかかることがあります。
`timeout` で設定した時間になってもAIがセリフを作り終えなかった場合、あらかじめ用意されたセリフが話されるか、何もセリフを発しません。

## 更新履歴
10/14/2023 回復システム、技の相性に依りダメージが変化するシステム、複数ステージで敵を倒すシステムを追加した

10/13/2023 デフォルトのプレイモードをCPU対戦モードに変更した

10/07/2023 ダメージ量が可変の技を追加した

09/06 ローカル2P対戦ができるようになった

## ゲームに使用している各種素材のクレジット

音楽：魔王魂